<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Horario IGPA 2026</title>
    <style>
        :root {
            --primary: #2c3e50;
            --accent: #3498db;
            --light: #ecf0f1;
            --danger: #e74c3c;
            --success: #27ae60;
            --yara-color: #d6eaf8; /* Azul claro */
            --karen-color: #d5f5e3; /* Verde claro */
            --claudia-color: #fce8d6; /* Naranja claro */
            --adela-color: #fadbd8; /* Rojo claro */
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f4f7f6;
            color: #333;
        }

        /* --- Header & Nav --- */
        header {
            background-color: var(--primary);
            color: white;
            padding: 1rem 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        h1 { margin: 0; font-size: 1.5rem; }

        .auth-controls button {
            background: rgba(255,255,255,0.2);
            border: none;
            color: white;
            padding: 8px 15px;
            cursor: pointer;
            border-radius: 4px;
            margin-left: 10px;
        }

        .auth-controls button:hover { background: rgba(255,255,255,0.3); }

        /* --- Main Layout --- */
        main { padding: 20px; max-width: 1400px; margin: 0 auto; }

        .tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            border-bottom: 2px solid #ddd;
            padding-bottom: 10px;
        }

        .tab-btn {
            padding: 10px 20px;
            border: none;
            background: #ddd;
            cursor: pointer;
            border-radius: 5px 5px 0 0;
            font-weight: bold;
            transition: 0.3s;
        }

        .tab-btn.active {
            background: var(--accent);
            color: white;
        }

        .view-section { display: none; }
        .view-section.active { display: block; }

        /* --- Tables --- */
        .table-container {
            overflow-x: auto;
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        table {
            width: 100%;
            border-collapse: collapse;
            min-width: 800px;
        }

        th, td {
            border: 1px solid #bdc3c7;
            padding: 10px;
            text-align: center;
            font-size: 0.9rem;
            vertical-align: top;
        }

        th {
            background-color: var(--primary);
            color: white;
            position: sticky;
            top: 0;
        }

        /* Highlight classes */
        .highlight-yara { background-color: var(--yara-color); }
        .highlight-karen { background-color: var(--karen-color); }
        .highlight-claudia { background-color: var(--claudia-color); }
        .highlight-adela { background-color: var(--adela-color); }
        .break-row { background-color: #ffeaa7; font-weight: bold; }

        /* --- Admin Controls --- */
        .admin-panel {
            background: white;
            padding: 15px;
            margin-bottom: 20px;
            border-radius: 8px;
            border-left: 5px solid var(--accent);
            display: flex;
            gap: 10px;
            align-items: center;
            flex-wrap: wrap;
        }

        .btn {
            padding: 8px 15px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-weight: bold;
            color: white;
        }

        .btn-save { background-color: var(--success); }
        .btn-danger { background-color: var(--danger); }
        .btn-primary { background-color: var(--accent); }
        
        input.edit-cell {
            width: 90%;
            border: 1px solid #ddd;
            padding: 5px;
            font-family: inherit;
        }

        /* --- Login Modal --- */
        #login-modal {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.5);
            display: none; /* Hidden by default */
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }

        .login-box {
            background: white;
            padding: 30px;
            border-radius: 8px;
            width: 300px;
            text-align: center;
        }

        .login-box input {
            width: 100%;
            padding: 10px;
            margin: 10px 0;
            box-sizing: border-box;
        }

        /* --- Print Styles --- */
        @media print {
            header, .tabs, .admin-panel, .auth-controls { display: none; }
            body { background: white; }
            .table-container { box-shadow: none; padding: 0; }
            th { background-color: #ccc !important; color: black !important; }
            td, th { border: 1px solid black !important; }
        }
    </style>
</head>
<body>

<header>
    <h1>üìÖ Horario IGPA 2026</h1>
    <div class="auth-controls">
        <span id="user-display" style="margin-right: 10px;">Vista: Estudiantes</span>
        <button id="btn-login" onclick="openLogin()">Soy Docente / Admin</button>
        <button id="btn-logout" onclick="logout()" style="display:none; background: #c0392b;">Salir</button>
    </div>
</header>

<main>
    <div id="login-modal">
        <div class="login-box">
            <h2>Iniciar Sesi√≥n</h2>
            <input type="text" id="username" placeholder="Usuario (ej: yara, karen)">
            <input type="password" id="password" placeholder="Contrase√±a (123)">
            <button class="btn btn-primary" onclick="attemptLogin()">Entrar</button>
            <button class="btn btn-danger" onclick="closeLogin()" style="margin-top: 10px;">Cancelar</button>
            <p id="login-error" style="color: red; display: none; font-size: 0.9em; margin-top: 5px;">Credenciales incorrectas</p>
        </div>
    </div>

    <div class="tabs" id="tabs-container">
        <button class="tab-btn active" onclick="switchTab('general')">Horario General</button>
        <button class="tab-btn" id="tab-my-schedule" onclick="switchTab('myschedule')" style="display:none;">Mi Horario</button>
        <button class="tab-btn" id="tab-editor" onclick="switchTab('editor')" style="display:none;">Editor Admin</button>
    </div>

    <div id="admin-tools" class="admin-panel" style="display:none;">
        <strong>Panel de Administraci√≥n:</strong>
        <button class="btn btn-success btn-save" onclick="saveChanges()">üíæ Guardar Cambios</button>
        <button class="btn btn-danger" onclick="resetData()">‚Üª Restaurar Original</button>
        <button class="btn btn-primary" onclick="printSchedule()">üñ®Ô∏è Imprimir</button>
        <select id="other-teacher-select" onchange="viewOtherTeacher(this.value)" style="padding: 8px;">
            <option value="">-- Ver horario de otra maestra --</option>
            <option value="Karen">Profa. Karen</option>
            <option value="Claudia">Profa. Claudia</option>
            <option value="Adela">Profa. Adela</option>
        </select>
    </div>

    <div id="view-general" class="view-section active">
        <div class="table-container">
            <h2 style="text-align: center;">Horario General de Clases</h2>
            <div id="general-table-render"></div>
        </div>
    </div>

    <div id="view-myschedule" class="view-section">
        <div class="table-container">
            <h2 style="text-align: center;">Mi Horario Individual</h2>
            <div id="personal-table-render"></div>
        </div>
    </div>

    <div id="view-editor" class="view-section">
        <div class="table-container">
            <h2 style="text-align: center; color: var(--danger);">Modo Edici√≥n</h2>
            <p style="text-align: center; font-size: 0.9em;">Edita los textos directamente. Haz clic en "Guardar Cambios" arriba para persistir.</p>
            <div id="editor-table-render"></div>
        </div>
    </div>
</main>

<script>
    // --- Initial Data (Based on PDF) ---
    const initialHeaders = [
        "HORA", "B√ÅSICO", "4TO. BACH EN COMPU", "4TO. PERITO / SECRE", "4TO. PERITO ADMON", "BACH. POR MADUREZ"
    ];

    const initialData = [
        ["08:00-08:35", "CIENCIAS NATURALES (Adela)", "", "CONTABILIDAD (Karen)", "", "SEMINARIO (Adela)"],
        ["08:35-09:10", "TICS (Yara)", "", "MATEM√ÅTICAS (Karen)", "", "PSICOLOG√çA (Adela)"],
        ["09:10-09:45", "GAR√çFUNA (Claudia)", "ESTAD√çSTICA (Karen)", "COMPUTACI√ìN (Yara)", "T√âCNICAS INV. (Adela)", "TICS (Yara)"],
        ["09:45-10:20", "EMPRENDIMIENTO (Adela)", "F√çSICA (Karen)", "INGL√âS COMERCIAL (Yara)", "ESTAD√çSTICA (Karen)", "CIENCIAS SOCIALES (Claudia)"],
        ["10:20-10:50", "RECESO", "RECESO", "RECESO", "RECESO", "RECESO"],
        ["10:50-11:25", "CIENCIAS SOCIALES (Claudia)", "PROGRAMACI√ìN (Yara)", "ORTOCALIGRAF√çA (Adela)", "MERCADOTECNIA (Yara)", "CIENCIAS NATURALES (Adela)"],
        ["11:25-12:00", "MATEM√ÅTICAS (Karen)", "CIENCIAS SOCIALES (Claudia)", "INTROD. ECONOM√çA (Claudia)", "INTROD. ECONOM√çA (Claudia)", "MATEM√ÅTICAS (Karen)"],
        ["12:00-12:35", "EXPRESI√ìN ART√çSTICA (Adela)", "L√ìGICA MATEM√ÅTICA (Karen)", "TAQUIGRAF√çA (Claudia)", "MATEM√ÅTICAS (Karen)", "EXPRESI√ìN ART√çSTICA (Adela)"],
        ["12:35-13:35", "ALMUERZO", "ALMUERZO", "ALMUERZO", "ALMUERZO", "ALMUERZO"],
        ["13:35-14:10", "INGL√âS (Yara)", "MANTENIMIENTO (Yara)", "PROGRAMACI√ìN (Yara)", "ADMON Y ORGA. (Claudia)", "ADMINISTRACI√ìN (Claudia)"],
        ["14:10-14:45", "MATEM√ÅTICAS (Karen)", "MATEM√ÅTICAS (Karen)", "ORTOCALIGRAF√çA (Adela)", "FUND. DERECHO (Adela)", "FILOSOF√çA (Claudia)"],
        ["14:45-15:20", "COM. Y LENGUAJE (Adela)", "COM. Y LENGUAJE (Adela)", "INGL√âS AVANZADO (Yara)", "ADMINISTRACI√ìN (Claudia)", "LENGUA Y LIT (Adela)"],
        ["15:20-15:55", "", "INGL√âS (Yara)", "CONTABILIDAD (Karen)", "SOCIOLOG√çA (Claudia)", "INGL√âS (Yara)"]
    ];

    // --- State Management ---
    let scheduleData = JSON.parse(localStorage.getItem('igpa_schedule')) || JSON.parse(JSON.stringify(initialData));
    let currentUser = null; // null, 'yara', 'karen', 'claudia', 'adela'

    const users = {
        'yara': { name: 'Inga. Yara Guzm√°n', role: 'admin', keywords: ['Yara'] },
        'karen': { name: 'Profa. Karen Supe', role: 'teacher', keywords: ['Karen'] },
        'claudia': { name: 'Profa. Claudia Catal√°n', role: 'teacher', keywords: ['Claudia'] },
        'adela': { name: 'Profa. Adela Jimenez', role: 'teacher', keywords: ['Adela'] }
    };

    // --- Rendering Logic ---

    function getCellClass(content) {
        if (!content) return '';
        content = content.toUpperCase();
        if (content.includes('RECESO') || content.includes('ALMUERZO')) return 'break-row';
        if (content.includes('YARA')) return 'highlight-yara';
        if (content.includes('KAREN')) return 'highlight-karen';
        if (content.includes('CLAUDIA')) return 'highlight-claudia';
        if (content.includes('ADELA')) return 'highlight-adela';
        return '';
    }

    function renderTable(containerId, data, isEditable = false, filterKeyword = null) {
        let html = '<table><thead><tr>';
        
        // Headers
        initialHeaders.forEach(h => html += `<th>${h}</th>`);
        html += '</tr></thead><tbody>';

        // Body
        data.forEach((row, rowIndex) => {
            // Check if row matches filter (if filter exists)
            // Logic: If filterKeyword is set, we only show rows where the teacher has a class, 
            // OR we show the time slot but empty out other cells.
            // Better logic for "My Schedule": Show time slots, but blank out cells that aren't mine.
            
            html += '<tr>';
            row.forEach((cell, colIndex) => {
                let displayContent = cell;
                let className = getCellClass(cell);

                // Filter Logic
                if (filterKeyword && colIndex > 0) { // Skip Time column (index 0)
                    const cellUpper = cell.toUpperCase();
                    const kwUpper = filterKeyword.toUpperCase();
                    
                    // Always show Breaks
                    if (!cellUpper.includes('RECESO') && !cellUpper.includes('ALMUERZO')) {
                        if (!cellUpper.includes(kwUpper)) {
                            displayContent = ""; // Hide content if it's not this teacher's class
                            className = ""; // Remove color
                        }
                    }
                }

                if (isEditable) {
                    html += `<td class="${className}"><input type="text" class="edit-cell" 
                             data-row="${rowIndex}" data-col="${colIndex}" 
                             value="${cell}" onchange="updateData(this)"></td>`;
                } else {
                    html += `<td class="${className}">${displayContent}</td>`;
                }
            });
            html += '</tr>';
        });

        html += '</tbody></table>';
        document.getElementById(containerId).innerHTML = html;
    }

    // --- Data Operations ---

    function updateData(input) {
        const r = input.dataset.row;
        const c = input.dataset.col;
        scheduleData[r][c] = input.value;
    }

    function saveChanges() {
        localStorage.setItem('igpa_schedule', JSON.stringify(scheduleData));
        alert('Cambios guardados exitosamente.');
        renderAllViews();
    }

    function resetData() {
        if(confirm("¬øEst√°s segura? Esto borrar√° todos los cambios personalizados.")) {
            scheduleData = JSON.parse(JSON.stringify(initialData));
            saveChanges();
        }
    }

    function renderAllViews() {
        renderTable('general-table-render', scheduleData, false);
        if (currentUser && currentUser.role === 'admin') {
            renderTable('editor-table-render', scheduleData, true);
        }
        if (currentUser) {
            // Render personal table based on current user keywords
            const kw = users[currentUser.username].keywords[0];
            renderTable('personal-table-render', scheduleData, false, kw);
        }
    }

    // --- Authentication & UI Logic ---

    function openLogin() { document.getElementById('login-modal').style.display = 'flex'; }
    function closeLogin() { document.getElementById('login-modal').style.display = 'none'; }

    function attemptLogin() {
        const u = document.getElementById('username').value.toLowerCase().trim();
        const p = document.getElementById('password').value;

        if (users[u] && p === '123') {
            currentUser = users[u];
            currentUser.username = u; // store key
            loginSuccess();
        } else {
            document.getElementById('login-error').style.display = 'block';
        }
    }

    function loginSuccess() {
        closeLogin();
        document.getElementById('btn-login').style.display = 'none';
        document.getElementById('btn-logout').style.display = 'inline-block';
        document.getElementById('user-display').innerText = `Hola, ${currentUser.name}`;
        
        document.getElementById('tab-my-schedule').style.display = 'block';
        
        if (currentUser.role === 'admin') {
            document.getElementById('tab-editor').style.display = 'block';
            document.getElementById('admin-tools').style.display = 'flex';
        }

        // Switch to personal view by default
        switchTab('myschedule');
        renderAllViews();
    }

    function logout() {
        currentUser = null;
        document.getElementById('btn-login').style.display = 'inline-block';
        document.getElementById('btn-logout').style.display = 'none';
        document.getElementById('user-display').innerText = 'Vista: Estudiantes';
        
        document.getElementById('tab-my-schedule').style.display = 'none';
        document.getElementById('tab-editor').style.display = 'none';
        document.getElementById('admin-tools').style.display = 'none';
        
        switchTab('general');
    }

    function switchTab(tabName) {
        // Hide all views
        document.querySelectorAll('.view-section').forEach(el => el.classList.remove('active'));
        document.querySelectorAll('.tab-btn').forEach(el => el.classList.remove('active'));

        // Show selected
        document.getElementById(`view-${tabName}`).classList.add('active');
        
        // Update buttons
        if(tabName === 'general') document.querySelector('.tabs button:nth-child(1)').classList.add('active');
        if(tabName === 'myschedule') document.getElementById('tab-my-schedule').classList.add('active');
        if(tabName === 'editor') document.getElementById('tab-editor').classList.add('active');
    }

    function viewOtherTeacher(teacherKeyword) {
        if(!teacherKeyword) return;
        // Temporarily render the "My Schedule" view with the selected teacher's filter
        renderTable('personal-table-render', scheduleData, false, teacherKeyword);
        switchTab('myschedule');
        document.querySelector('#view-myschedule h2').innerText = `Horario: ${teacherKeyword}`;
    }

    function printSchedule() {
        window.print();
    }

    // --- Init ---
    renderTable('general-table-render', scheduleData);

</script>

</body>
</html>
