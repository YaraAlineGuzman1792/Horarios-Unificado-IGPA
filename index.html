<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Horario Escolar - Sistema de Gestión</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background-color: #f5f7fa;
            color: #333;
            line-height: 1.6;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        header {
            background: linear-gradient(135deg, #1a237e 0%, #283593 100%);
            color: white;
            padding: 20px 0;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            margin-bottom: 30px;
        }

        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 20px;
        }

        .logo-container {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .logo {
            font-size: 2.5rem;
            color: #ffcc00;
        }

        h1 {
            font-size: 1.8rem;
        }

        .login-section {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .user-info {
            display: flex;
            align-items: center;
            gap: 10px;
            background: rgba(255, 255, 255, 0.15);
            padding: 8px 15px;
            border-radius: 50px;
        }

        .user-icon {
            font-size: 1.2rem;
        }

        .login-btn, .logout-btn {
            background-color: #ffcc00;
            color: #1a237e;
            border: none;
            padding: 8px 20px;
            border-radius: 50px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }

        .login-btn:hover, .logout-btn:hover {
            background-color: #ffd633;
            transform: translateY(-2px);
        }

        .tab-container {
            display: flex;
            margin-bottom: 25px;
            background-color: white;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.05);
        }

        .tab {
            flex: 1;
            padding: 15px 20px;
            text-align: center;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            border-bottom: 3px solid transparent;
        }

        .tab:hover {
            background-color: #f0f2f5;
        }

        .tab.active {
            color: #1a237e;
            border-bottom: 3px solid #1a237e;
            background-color: #f8f9fa;
        }

        .content-section {
            display: none;
            animation: fadeIn 0.5s;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .content-section.active {
            display: block;
        }

        .schedule-container {
            overflow-x: auto;
            background-color: white;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
            margin-bottom: 30px;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            min-width: 1200px;
        }

        th {
            background-color: #1a237e;
            color: white;
            padding: 15px 10px;
            text-align: center;
            font-weight: 600;
            border-right: 1px solid #283593;
            position: sticky;
            top: 0;
            z-index: 10;
        }

        th:first-child {
            background-color: #283593;
        }

        td {
            padding: 12px 8px;
            border: 1px solid #e1e5eb;
            text-align: center;
            vertical-align: top;
        }

        tr:nth-child(even) {
            background-color: #f9fafc;
        }

        .time-cell {
            background-color: #f0f2f5;
            font-weight: 600;
            color: #1a237e;
        }

        .break-row {
            background-color: #fff8e1 !important;
            font-weight: 600;
            color: #ff8f00;
            text-align: center;
        }

        .lunch-row {
            background-color: #f3e5f5 !important;
            font-weight: 600;
            color: #7b1fa2;
            text-align: center;
        }

        .class-info {
            font-size: 0.85rem;
            padding: 5px;
            border-radius: 5px;
            margin-bottom: 3px;
        }

        .teacher-1 { background-color: #e3f2fd; border-left: 4px solid #2196f3; }
        .teacher-2 { background-color: #f3e5f5; border-left: 4px solid #9c27b0; }
        .teacher-3 { background-color: #e8f5e9; border-left: 4px solid #4caf50; }
        .teacher-4 { background-color: #fff3e0; border-left: 4px solid #ff9800; }

        .admin-panel {
            background-color: white;
            border-radius: 10px;
            padding: 25px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
            margin-top: 20px;
        }

        .panel-title {
            color: #1a237e;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid #e8eaf6;
        }

        .controls {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            margin-bottom: 25px;
        }

        .control-btn {
            background-color: #1a237e;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: all 0.3s;
        }

        .control-btn:hover {
            background-color: #283593;
            transform: translateY(-2px);
        }

        .danger-btn {
            background-color: #d32f2f;
        }

        .danger-btn:hover {
            background-color: #f44336;
        }

        .edit-form {
            background-color: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            margin-top: 20px;
            display: none;
        }

        .form-group {
            margin-bottom: 15px;
        }

        label {
            display: block;
            margin-bottom: 5px;
            font-weight: 600;
            color: #1a237e;
        }

        input, select {
            width: 100%;
            padding: 10px;
            border: 1px solid #ccc;
            border-radius: 5px;
            font-size: 1rem;
        }

        .form-actions {
            display: flex;
            gap: 10px;
            margin-top: 20px;
        }

        .save-btn {
            background-color: #4caf50;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
        }

        .cancel-btn {
            background-color: #9e9e9e;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
        }

        .login-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            display: none;
        }

        .modal-content {
            background-color: white;
            padding: 30px;
            border-radius: 10px;
            width: 90%;
            max-width: 400px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
        }

        .modal-title {
            color: #1a237e;
            margin-bottom: 20px;
            text-align: center;
        }

        .close-modal {
            position: absolute;
            top: 15px;
            right: 15px;
            font-size: 1.5rem;
            cursor: pointer;
            color: #757575;
        }

        .teacher-class {
            font-weight: 600;
            color: #1a237e;
        }

        .teacher-name {
            font-size: 0.8rem;
            color: #666;
        }

        footer {
            text-align: center;
            margin-top: 40px;
            padding: 20px;
            color: #666;
            border-top: 1px solid #e1e5eb;
        }

        @media (max-width: 768px) {
            .header-content {
                flex-direction: column;
                gap: 15px;
                text-align: center;
            }
            
            .controls {
                flex-direction: column;
            }
            
            .control-btn {
                justify-content: center;
            }
        }
    </style>
</head>
<body>
    <header>
        <div class="header-content">
            <div class="logo-container">
                <i class="fas fa-calendar-alt logo"></i>
                <div>
                    <h1>Horario Escolar - Sistema de Gestión</h1>
                    <p>Instituto Técnico Profesional</p>
                </div>
            </div>
            <div class="login-section">
                <div id="userInfo" class="user-info" style="display: none;">
                    <i class="fas fa-user-circle user-icon"></i>
                    <span id="userName"></span>
                </div>
                <button id="loginBtn" class="login-btn">
                    <i class="fas fa-sign-in-alt"></i> Iniciar Sesión
                </button>
                <button id="logoutBtn" class="logout-btn" style="display: none;">
                    <i class="fas fa-sign-out-alt"></i> Cerrar Sesión
                </button>
            </div>
        </div>
    </header>

    <div class="container">
        <div class="tab-container">
            <div class="tab active" data-tab="schedule">Horario General</div>
            <div class="tab" data-tab="teacher-view">Vista Maestros</div>
            <div class="tab" data-tab="admin-panel">Panel Administrador</div>
        </div>

        <div id="schedule-section" class="content-section active">
            <h2>Horario Escolar - Semana del 10 al 14 de Junio</h2>
            <div class="schedule-container">
                <table id="scheduleTable">
                    <thead>
                        <tr>
                            <th>HORA</th>
                            <th>Primero y Segundo básico</th>
                            <th>Tercero básico</th>
                            <th>5to Bach</th>
                            <th>Bachillerato por Madurez</th>
                            <th>4to y 5to</th>
                            <th>Secretariado</th>
                            <th>PERITO CONTADOR</th>
                        </tr>
                    </thead>
                    <tbody id="scheduleBody">
                        <!-- Los horarios se cargarán con JavaScript -->
                    </tbody>
                </table>
            </div>
        </div>

        <div id="teacher-view-section" class="content-section">
            <h2>Vista para Maestros</h2>
            <div class="schedule-container">
                <table id="teacherScheduleTable">
                    <thead>
                        <tr>
                            <th>HORA</th>
                            <th>Lunes</th>
                            <th>Martes</th>
                            <th>Miércoles</th>
                            <th>Jueves</th>
                            <th>Viernes</th>
                        </tr>
                    </thead>
                    <tbody id="teacherScheduleBody">
                        <!-- El horario del maestro se cargará con JavaScript -->
                    </tbody>
                </table>
            </div>
        </div>

        <div id="admin-panel-section" class="content-section">
            <h2>Panel de Administración</h2>
            <p>Esta sección es solo para el administrador (Yara Guzmán). Desde aquí puede modificar el horario, agregar o eliminar filas/columnas.</p>
            
            <div class="admin-panel">
                <h3 class="panel-title">Controles de Edición</h3>
                
                <div class="controls">
                    <button id="addRowBtn" class="control-btn">
                        <i class="fas fa-plus"></i> Agregar Fila
                    </button>
                    <button id="addColumnBtn" class="control-btn">
                        <i class="fas fa-plus"></i> Agregar Columna
                    </button>
                    <button id="removeRowBtn" class="control-btn danger-btn">
                        <i class="fas fa-minus"></i> Eliminar Fila
                    </button>
                    <button id="removeColumnBtn" class="control-btn danger-btn">
                        <i class="fas fa-minus"></i> Eliminar Columna
                    </button>
                    <button id="editCellBtn" class="control-btn">
                        <i class="fas fa-edit"></i> Editar Celda
                    </button>
                    <button id="saveChangesBtn" class="control-btn" style="background-color: #4caf50;">
                        <i class="fas fa-save"></i> Guardar Cambios
                    </button>
                </div>
                
                <div id="editForm" class="edit-form">
                    <h4>Editar Celda</h4>
                    <div class="form-group">
                        <label for="cellContent">Contenido:</label>
                        <textarea id="cellContent" rows="4" placeholder="Ingrese el contenido de la celda (materia y profesor)"></textarea>
                    </div>
                    <div class="form-group">
                        <label for="cellType">Tipo de Celda:</label>
                        <select id="cellType">
                            <option value="class">Clase normal</option>
                            <option value="break">Receso</option>
                            <option value="lunch">Almuerzo</option>
                            <option value="time">Hora</option>
                        </select>
                    </div>
                    <div class="form-actions">
                        <button id="saveCellBtn" class="save-btn">Guardar Cambios</button>
                        <button id="cancelEditBtn" class="cancel-btn">Cancelar</button>
                    </div>
                </div>
                
                <div id="adminMessage" style="margin-top: 20px; padding: 15px; background-color: #e8f5e9; border-radius: 5px; display: none;">
                    <i class="fas fa-check-circle"></i> <span id="messageText"></span>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal de Login -->
    <div id="loginModal" class="login-modal">
        <div class="modal-content">
            <span class="close-modal" id="closeModal">&times;</span>
            <h3 class="modal-title">Iniciar Sesión</h3>
            <div class="form-group">
                <label for="username">Usuario:</label>
                <input type="text" id="username" placeholder="Ingrese su usuario">
            </div>
            <div class="form-group">
                <label for="password">Contraseña:</label>
                <input type="password" id="password" placeholder="Ingrese su contraseña">
            </div>
            <div class="form-group">
                <label for="role">Rol:</label>
                <select id="role">
                    <option value="student">Estudiante (solo lectura)</option>
                    <option value="teacher-karen">Prof. Karen Supe</option>
                    <option value="teacher-adela">Prof. Adela Jiménez</option>
                    <option value="teacher-claudia">Prof. Claudia Catalán</option>
                    <option value="admin-yara">Admin. Yara Guzmán</option>
                </select>
            </div>
            <div class="form-actions">
                <button id="modalLoginBtn" class="save-btn" style="width: 100%;">Iniciar Sesión</button>
            </div>
            <p style="margin-top: 15px; text-align: center; font-size: 0.9rem;">
                <strong>Acceso rápido:</strong> Para estudiantes, no se requiere contraseña. Para maestros y administrador, use cualquier contraseña.
            </p>
        </div>
    </div>

    <footer>
        <p>Sistema de Gestión de Horarios Escolares &copy; 2023 - Instituto Técnico Profesional</p>
        <p>Horario de clases: 8:00 AM - 3:30 PM | Receso: 10:00 AM - 10:30 AM | Almuerzo: 12:30 PM - 1:30 PM</p>
    </footer>

    <script>
        // Datos del horario basados en la imagen proporcionada
        const scheduleData = [
            {
                time: "08:00-08:35",
                columns: [
                    "Matemáticas Mtra. Elvia Xiloj",
                    "Culturas e Idiomas Mayas Mtra. Karla Xiloj",
                    "Programación II Mtro. Bryan Juárez",
                    "Lengua y Literatura Mtra. Yaneth Withfield",
                    "Teoría del Derecho Mtra. Soochil Martínez",
                    "Catalogación y Archivo Mtra. Odeth Vásquez",
                    "Catalogación y Archivo Mtra. Odeth Vásquez"
                ]
            },
            {
                time: "08:35-09:10",
                columns: [
                    "Culturas e Idiomas Mayas Mtra. Karla Xiloj",
                    "Comunicación y Lenguaje Mtra. Yaneth Withfield",
                    "Matemáticas II Mtra. Elvia Xiloj",
                    "TICS Mtro. Bryan Juárez",
                    "Principios Generales del Derecho Mtra. Odeth Vásquez",
                    "Redacción y Correspondencia II Mtra. Soochil Martínez",
                    "Principios Generales del Derecho Mtra. Odeth Vásquez"
                ]
            },
            {
                time: "09:10-09:45",
                columns: [
                    "TACS Mtro. Bryan Juárez",
                    "Matemáticas Mtra. Elvia Xiloj",
                    "Administración Mtra. Soochil Martínez",
                    "Expresión Artística Mtra. Odeth Vásquez",
                    "Mercadotecnia Mtra. Karla Xiloj",
                    "Ingles Comercial Mtra. Yaneth Withfield",
                    "Ingles Comercial Mtra. Yaneth Withfield"
                ]
            },
            {
                type: "break",
                time: "09:45-10:20",
                label: "RECESO"
            },
            {
                time: "10:20-10:55",
                columns: [
                    "Comunicación y Lenguaje Mtra. Yaneth Withfield",
                    "Ciencias Naturales Mtra. Odeth Vásquez",
                    "Educación Estética y Practica Supervisada Mtra. Karla Xiloj",
                    "Filosofía Mtra. Soochil Martínez",
                    "Computación Mtro. Bryan Juárez",
                    "Taquigrafía II Mtra. Elvia Xiloj",
                    "Computación Mtro. Bryan Juárez"
                ]
            },
            {
                time: "10:55-11:30",
                columns: [
                    "Ciencias Naturales Mtra. Odeth Vásquez",
                    "TACS Mtro. Bryan Juárez",
                    "Ingles Técnico Mtra. Yaneth Withfield",
                    "Matemáticas Mtra. Elvia Xiloj",
                    "Administración II Mtra. Soochil Martínez",
                    "Administración y Práctica de Oficina Mtra. Karla Xiloj",
                    "Administración y Práctica de Oficina Mtra. Karla Xiloj"
                ]
            },
            {
                time: "11:30-12:05",
                columns: [
                    "Emprendimiento para la productividad Mtra. Soochil Martínez",
                    "Emprendimiento para la Productividad Mtra. Karla Xiloj",
                    "Técnico en Reparación de Computadoras Mtro. Bryan Juárez",
                    "Ciencias Naturales Mtra. Odeth Vásquez",
                    "Estadística Mtra. Elvia Xiloj",
                    "Ingles Avanzado Mtra. Yaneth Withfield",
                    "Estadística Mtra. Elvia Xiloj"
                ]
            },
            {
                type: "lunch",
                time: "12:05-13:05",
                label: "ALMUERZO"
            },
            {
                time: "13:05-13:40",
                columns: [
                    "Teatro y Danza Mtra. Karla Xiloj",
                    "Educación Artística I Mtra. Odeth Vásquez",
                    "Técnico en Mantenimiento de Computadoras Mtro. Bryan Juárez",
                    "Ciencias Sociales y Formación Ciudadana Mtra. Soochil Martínez",
                    "Contabilidad Mtra. Elvia Xiloj",
                    "Taquigrafía en Ingles Mtra. Yaneth Withfield",
                    "Contabilidad Mtra. Elvia Xiloj"
                ]
            },
            {
                time: "13:40-14:15",
                columns: [
                    "Ingles Mtra. Yaneth Withfield",
                    "Ciencias Sociales Mtra. Soochil Martínez",
                    "Ética y Relaciones Humanas Mtra. Odeth Vásquez",
                    "Psicología Mtra. Karla Xiloj",
                    "Matemáticas Financiera Mtra. Elvia Xiloj",
                    "Computación Mtro. Bryan Juárez",
                    "Ética y Relaciones Humanas Mtra. Odeth Vásquez"
                ]
            },
            {
                time: "14:15-15:00",
                columns: [
                    "Artes Visuales Mtra. Odeth Vásquez",
                    "Ingles Mtra. Yaneth Withfield",
                    "Contabilidad Mtra. Elvia Xiloj",
                    "Computación II Mtro. Bryan Juárez",
                    "Teoría Económica Mtra. Soochil Martínez",
                    "Ortografía II Mtra. Karla Xiloj",
                    "Contabilidad Mtra. Elvia Xiloj"
                ]
            },
            {
                time: "15:00-15:45",
                columns: [
                    "Ciencias Sociales Mtra. Soochil Martínez",
                    "Contabilidad Mtra. Elvia Xiloj",
                    "Seminario Mtra. Karla Xiloj",
                    "Seminario Mtra. Odeth Vásquez",
                    "Psicología Aplicada a la Empresa Mtra. Yaneth Withfield",
                    "Mecanografía Mtro. Bryan Juárez",
                    "Seminario Mtra. Odeth Vásquez"
                ]
            }
        ];

        // Asignación de maestros a colores
        const teacherColors = {
            "Mtra. Elvia Xiloj": "teacher-1",
            "Mtra. Karla Xiloj": "teacher-2",
            "Mtro. Bryan Juárez": "teacher-3",
            "Mtra. Yaneth Withfield": "teacher-4",
            "Mtra. Soochil Martínez": "teacher-1",
            "Mtra. Odeth Vásquez": "teacher-2"
        };

        // Estado de la aplicación
        let currentUser = null;
        let editingCell = null;
        let scheduleDataCopy = JSON.parse(JSON.stringify(scheduleData));

        // Inicializar la aplicación
        document.addEventListener('DOMContentLoaded', function() {
            renderSchedule();
            setupEventListeners();
            loadTeacherSchedule();
        });

        // Renderizar el horario principal
        function renderSchedule() {
            const scheduleBody = document.getElementById('scheduleBody');
            scheduleBody.innerHTML = '';
            
            scheduleDataCopy.forEach(rowData => {
                const row = document.createElement('tr');
                
                // Celda de tiempo
                const timeCell = document.createElement('td');
                timeCell.className = 'time-cell';
                timeCell.textContent = rowData.time;
                row.appendChild(timeCell);
                
                // Si es receso o almuerzo
                if (rowData.type === 'break' || rowData.type === 'lunch') {
                    const breakCell = document.createElement('td');
                    breakCell.colSpan = 7;
                    breakCell.className = rowData.type === 'break' ? 'break-row' : 'lunch-row';
                    breakCell.textContent = rowData.label;
                    row.appendChild(breakCell);
                } else {
                    // Celdas normales con clases
                    rowData.columns.forEach((classInfo, index) => {
                        const cell = document.createElement('td');
                        
                        if (classInfo) {
                            const classDiv = document.createElement('div');
                            classDiv.className = 'class-info';
                            
                            // Encontrar el profesor para asignar color
                            let teacherClass = '';
                            for (const teacher in teacherColors) {
                                if (classInfo.includes(teacher)) {
                                    teacherClass = teacherColors[teacher];
                                    break;
                                }
                            }
                            
                            classDiv.className += ' ' + teacherClass;
                            classDiv.innerHTML = `<div class="teacher-class">${classInfo.split(' ')[0]}</div>
                                                  <div class="teacher-name">${classInfo.substring(classInfo.indexOf(' ') + 1)}</div>`;
                            cell.appendChild(classDiv);
                        }
                        
                        row.appendChild(cell);
                    });
                }
                
                scheduleBody.appendChild(row);
            });
        }

        // Configurar los event listeners
        function setupEventListeners() {
            // Tabs
            document.querySelectorAll('.tab').forEach(tab => {
                tab.addEventListener('click', function() {
                    const tabId = this.getAttribute('data-tab');
                    
                    // Actualizar tabs activos
                    document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
                    this.classList.add('active');
                    
                    // Mostrar la sección correspondiente
                    document.querySelectorAll('.content-section').forEach(section => {
                        section.classList.remove('active');
                    });
                    document.getElementById(tabId + '-section').classList.add('active');
                });
            });
            
            // Botón de login
            document.getElementById('loginBtn').addEventListener('click', function() {
                document.getElementById('loginModal').style.display = 'flex';
            });
            
            // Cerrar modal
            document.getElementById('closeModal').addEventListener('click', function() {
                document.getElementById('loginModal').style.display = 'none';
            });
            
            // Login desde el modal
            document.getElementById('modalLoginBtn').addEventListener('click', function() {
                const username = document.getElementById('username').value;
                const password = document.getElementById('password').value;
                const role = document.getElementById('role').value;
                
                // Para estudiantes, no se requiere contraseña
                if (role === 'student' || (username && password)) {
                    loginUser(role, username || 'Estudiante');
                } else {
                    alert('Por favor, complete los campos de usuario y contraseña');
                }
            });
            
            // Cerrar sesión
            document.getElementById('logoutBtn').addEventListener('click', function() {
                logoutUser();
            });
            
            // Controles de administrador
            document.getElementById('addRowBtn').addEventListener('click', addRow);
            document.getElementById('addColumnBtn').addEventListener('click', addColumn);
            document.getElementById('removeRowBtn').addEventListener('click', removeRow);
            document.getElementById('removeColumnBtn').addEventListener('click', removeColumn);
            document.getElementById('editCellBtn').addEventListener('click', startEditCell);
            document.getElementById('saveCellBtn').addEventListener('click', saveCellEdit);
            document.getElementById('cancelEditBtn').addEventListener('click', cancelEdit);
            document.getElementById('saveChangesBtn').addEventListener('click', saveAllChanges);
            
            // Hacer las celdas editables al hacer clic (solo para admin)
            document.addEventListener('click', function(e) {
                if (currentUser === 'admin-yara' && e.target.tagName === 'TD' && !e.target.classList.contains('time-cell') && 
                    !e.target.classList.contains('break-row') && !e.target.classList.contains('lunch-row')) {
                    startEditCell(e.target);
                }
            });
        }

        // Login de usuario
        function loginUser(role, username) {
            currentUser = role;
            
            // Ocultar modal
            document.getElementById('loginModal').style.display = 'none';
            
            // Mostrar información del usuario
            document.getElementById('userName').textContent = getDisplayName(role);
            document.getElementById('userInfo').style.display = 'flex';
            document.getElementById('loginBtn').style.display = 'none';
            document.getElementById('logoutBtn').style.display = 'block';
            
            // Mostrar/ocultar tabs según el rol
            document.querySelectorAll('.tab').forEach(tab => {
                const tabId = tab.getAttribute('data-tab');
                
                // Estudiantes solo ven el horario
                if (role === 'student') {
                    if (tabId !== 'schedule') {
                        tab.style.display = 'none';
                    }
                }
                // Maestros ven horario y su vista
                else if (role.startsWith('teacher-')) {
                    if (tabId === 'admin-panel') {
                        tab.style.display = 'none';
                    }
                }
                // Admin ve todo
                else if (role === 'admin-yara') {
                    tab.style.display = 'flex';
                }
                
                // Activar la primera tab visible
                if (tab.style.display !== 'none') {
                    tab.classList.add('active');
                    document.getElementById(tabId + '-section').classList.add('active');
                    break;
                }
            });
            
            // Cargar vista del maestro si corresponde
            if (role.startsWith('teacher-')) {
                loadTeacherSchedule();
            }
            
            // Limpiar formulario
            document.getElementById('username').value = '';
            document.getElementById('password').value = '';
            
            // Mostrar mensaje de bienvenida
            alert(`Bienvenido/a ${getDisplayName(role)}`);
        }

        // Cerrar sesión
        function logoutUser() {
            currentUser = null;
            
            // Ocultar información del usuario
            document.getElementById('userInfo').style.display = 'none';
            document.getElementById('loginBtn').style.display = 'block';
            document.getElementById('logoutBtn').style.display = 'none';
            
            // Mostrar todas las tabs
            document.querySelectorAll('.tab').forEach(tab => {
                tab.style.display = 'flex';
            });
            
            // Activar solo la primera tab
            document.querySelectorAll('.tab').forEach(tab => tab.classList.remove('active'));
            document.querySelectorAll('.content-section').forEach(section => section.classList.remove('active'));
            
            document.querySelector('.tab').classList.add('active');
            document.getElementById('schedule-section').classList.add('active');
        }

        // Obtener nombre para mostrar según rol
        function getDisplayName(role) {
            switch(role) {
                case 'student': return 'Estudiante';
                case 'teacher-karen': return 'Prof. Karen Supe';
                case 'teacher-adela': return 'Prof. Adela Jiménez';
                case 'teacher-claudia': return 'Prof. Claudia Catalán';
                case 'admin-yara': return 'Admin. Yara Guzmán';
                default: return 'Usuario';
            }
        }

        // Cargar horario del maestro
        function loadTeacherSchedule() {
            const teacherScheduleBody = document.getElementById('teacherScheduleBody');
            teacherScheduleBody.innerHTML = '';
            
            // Horario de ejemplo para maestros
            const teacherSchedule = [
                { time: "08:00-08:35", classes: ["Matemáticas - 1ro Básico", "", "Matemáticas II - 5to Bach", "", "Teoría del Derecho - 4to/5to"] },
                { time: "08:35-09:10", classes: ["", "Comunicación - 3ro Básico", "", "Lengua y Literatura - Bach Madurez", ""] },
                { time: "09:10-09:45", classes: ["", "", "Administración - 5to Bach", "", "Mercadotecnia - 4to/5to"] },
                { time: "09:45-10:20", classes: ["RECESO", "RECESO", "RECESO", "RECESO", "RECESO"] },
                { time: "10:20-10:55", classes: ["Comunicación - 1ro/2do Básico", "", "", "Filosofía - Bach Madurez", ""] },
                { time: "10:55-11:30", classes: ["", "", "Inglés Técnico - 5to Bach", "Matemáticas - Bach Madurez", "Administración II - 4to/5to"] },
                { time: "11:30-12:05", classes: ["Emprendimiento - 1ro/2do Básico", "", "", "", "Estadística - 4to/5to"] },
                { time: "12:05-13:05", classes: ["ALMUERZO", "ALMUERZO", "ALMUERZO", "ALMUERZO", "ALMUERZO"] },
                { time: "13:05-13:40", classes: ["", "", "", "Ciencias Sociales - Bach Madurez", "Contabilidad - 4to/5to"] },
                { time: "13:40-14:15", classes: ["", "Ciencias Sociales - 3ro Básico", "", "", "Matemáticas Financiera - 4to/5to"] },
                { time: "14:15-15:00", classes: ["", "", "Contabilidad - 5to Bach", "", "Teoría Económica - 4to/5to"] },
                { time: "15:00-15:45", classes: ["Ciencias Sociales - 1ro/2do Básico", "", "Seminario - 5to Bach", "Seminario - Bach Madurez", ""] }
            ];
            
            // Ajustar según el maestro
            if (currentUser === 'teacher-karen') {
                // Prof. Karen Supe - Área Numérica y Contable
                teacherSchedule.forEach(row => {
                    row.classes = row.classes.map(cls => {
                        if (cls.includes("Matemáticas") || cls.includes("Contabilidad") || cls.includes("Estadística") || cls.includes("Matemáticas Financiera")) {
                            return cls;
                        }
                        return "";
                    });
                });
            } else if (currentUser === 'teacher-adela') {
                // Prof. Adela Jiménez - Área Humanística y Científica
                teacherSchedule.forEach(row => {
                    row.classes = row.classes.map(cls => {
                        if (cls.includes("Comunicación") || cls.includes("Lengua") || cls.includes("Ciencias Naturales") || 
                            cls.includes("Expresión") || cls.includes("Psicología") || cls.includes("Ortografía") || 
                            cls.includes("Emprendimiento")) {
                            return cls;
                        }
                        return "";
                    });
                });
            } else if (currentUser === 'teacher-claudia') {
                // Prof. Claudia Catalán - Área Social y Administrativa
                teacherSchedule.forEach(row => {
                    row.classes = row.classes.map(cls => {
                        if (cls.includes("Ciencias Sociales") || cls.includes("Filosofía") || cls.includes("Administración") || 
                            cls.includes("Economía") || cls.includes("Redacción") || cls.includes("Mercadotecnia")) {
                            return cls;
                        }
                        return "";
                    });
                });
            }
            
            // Renderizar horario del maestro
            teacherSchedule.forEach(rowData => {
                const row = document.createElement('tr');
                
                const timeCell = document.createElement('td');
                timeCell.className = 'time-cell';
                timeCell.textContent = rowData.time;
                row.appendChild(timeCell);
                
                rowData.classes.forEach((cls, index) => {
                    const cell = document.createElement('td');
                    
                    if (cls === "RECESO") {
                        cell.className = 'break-row';
                        cell.textContent = cls;
                    } else if (cls === "ALMUERZO") {
                        cell.className = 'lunch-row';
                        cell.textContent = cls;
                    } else if (cls) {
                        const classDiv = document.createElement('div');
                        classDiv.className = 'class-info teacher-1';
                        classDiv.innerHTML = `<div class="teacher-class">${cls}</div>`;
                        cell.appendChild(classDiv);
                    }
                    
                    row.appendChild(cell);
                });
                
                teacherScheduleBody.appendChild(row);
            });
        }

        // Funciones del panel de administración
        function addRow() {
            if (currentUser !== 'admin-yara') {
                alert('Solo el administrador puede realizar esta acción');
                return;
            }
            
            // Encontrar la última hora para calcular la siguiente
            const lastRow = scheduleDataCopy[scheduleDataCopy.length - 1];
            let lastTime = lastRow.time;
            let lastEndTime = parseInt(lastTime.split('-')[1].replace(':', ''));
            
            // Calcular nueva hora (sumar 45 minutos)
            let newStartTime = lastEndTime;
            let newEndTime = newStartTime + 45;
            
            // Ajustar formato de hora
            let startHour = Math.floor(newStartTime / 100);
            let startMinute = newStartTime % 100;
            
            let endHour = Math.floor(newEndTime / 100);
            let endMinute = newEndTime % 100;
            
            // Ajustar si los minutos superan 60
            if (startMinute >= 60) {
                startHour += 1;
                startMinute -= 60;
            }
            
            if (endMinute >= 60) {
                endHour += 1;
                endMinute -= 60;
            }
            
            const newTime = `${startHour.toString().padStart(2, '0')}:${startMinute.toString().padStart(2, '0')}-${endHour.toString().padStart(2, '0')}:${endMinute.toString().padStart(2, '0')}`;
            
            // Agregar nueva fila
            scheduleDataCopy.push({
                time: newTime,
                columns: ["", "", "", "", "", "", ""]
            });
            
            renderSchedule();
            showAdminMessage('Fila agregada correctamente');
        }

        function addColumn() {
            if (currentUser !== 'admin-yara') {
                alert('Solo el administrador puede realizar esta acción');
                return;
            }
            
            // Agregar una nueva columna a todas las filas
            scheduleDataCopy.forEach(row => {
                if (row.columns) {
                    row.columns.push("");
                }
            });
            
            // Actualizar encabezados de la tabla
            const tableHeader = document.querySelector('#scheduleTable thead tr');
            const newHeader = document.createElement('th');
            newHeader.textContent = `Nuevo Grado ${tableHeader.children.length}`;
            tableHeader.appendChild(newHeader);
            
            renderSchedule();
            showAdminMessage('Columna agregada correctamente');
        }

        function removeRow() {
            if (currentUser !== 'admin-yara') {
                alert('Solo el administrador puede realizar esta acción');
                return;
            }
            
            if (scheduleDataCopy.length <= 1) {
                alert('No se puede eliminar la última fila');
                return;
            }
            
            scheduleDataCopy.pop();
            renderSchedule();
            showAdminMessage('Última fila eliminada');
        }

        function removeColumn() {
            if (currentUser !== 'admin-yara') {
                alert('Solo el administrador puede realizar esta acción');
                return;
            }
            
            const tableHeader = document.querySelector('#scheduleTable thead tr');
            if (tableHeader.children.length <= 2) {
                alert('No se puede eliminar la última columna');
                return;
            }
            
            // Eliminar última columna de todas las filas
            scheduleDataCopy.forEach(row => {
                if (row.columns && row.columns.length > 1) {
                    row.columns.pop();
                }
            });
            
            // Eliminar último encabezado
            tableHeader.removeChild(tableHeader.lastChild);
            
            renderSchedule();
            showAdminMessage('Última columna eliminada');
        }

        function startEditCell(cell) {
            if (currentUser !== 'admin-yara') {
                alert('Solo el administrador puede realizar esta acción');
                return;
            }
            
            // Si se llama desde un clic en celda
            if (cell instanceof Event) {
                cell = null;
                const selectedCell = prompt('Seleccione una celda para editar (ejemplo: B3, D5):');
                if (!selectedCell) return;
                
                // Aquí se implementaría la lógica para encontrar la celda por coordenadas
                alert('Para editar una celda, haga clic directamente sobre ella en la tabla');
                return;
            }
            
            // Si se pasó una celda directamente
            if (cell) {
                editingCell = cell;
                const rowIndex = cell.parentNode.rowIndex - 1; // Restar 1 por el encabezado
                const cellIndex = cell.cellIndex;
                
                // Encontrar el contenido actual
                let currentContent = '';
                if (cellIndex === 0) {
                    currentContent = scheduleDataCopy[rowIndex].time;
                } else if (scheduleDataCopy[rowIndex].type) {
                    currentContent = scheduleDataCopy[rowIndex].label;
                } else if (cellIndex > 0) {
                    currentContent = scheduleDataCopy[rowIndex].columns[cellIndex - 1] || '';
                }
                
                // Mostrar formulario de edición
                document.getElementById('cellContent').value = currentContent;
                
                // Determinar tipo de celda
                let cellType = 'class';
                if (cell.classList.contains('time-cell')) cellType = 'time';
                if (cell.classList.contains('break-row')) cellType = 'break';
                if (cell.classList.contains('lunch-row')) cellType = 'lunch';
                
                document.getElementById('cellType').value = cellType;
                document.getElementById('editForm').style.display = 'block';
                
                // Desplazar hacia el formulario
                document.getElementById('editForm').scrollIntoView({ behavior: 'smooth' });
            }
        }

        function saveCellEdit() {
            if (!editingCell) return;
            
            const newContent = document.getElementById('cellContent').value;
            const cellType = document.getElementById('cellType').value;
            const rowIndex = editingCell.parentNode.rowIndex - 1;
            const cellIndex = editingCell.cellIndex;
            
            // Actualizar datos
            if (cellIndex === 0) {
                // Celda de tiempo
                scheduleDataCopy[rowIndex].time = newContent;
            } else if (cellType === 'break' || cellType === 'lunch') {
                // Receso o almuerzo
                scheduleDataCopy[rowIndex].type = cellType;
                scheduleDataCopy[rowIndex].label = newContent;
                // Eliminar columnas si existían
                delete scheduleDataCopy[rowIndex].columns;
            } else {
                // Celda normal de clase
                if (scheduleDataCopy[rowIndex].type) {
                    // Si antes era receso/almuerzo, convertirlo a fila normal
                    delete scheduleDataCopy[rowIndex].type;
                    delete scheduleDataCopy[rowIndex].label;
                    scheduleDataCopy[rowIndex].columns = ["", "", "", "", "", "", ""];
                }
                
                scheduleDataCopy[rowIndex].columns[cellIndex - 1] = newContent;
            }
            
            // Re-renderizar
            renderSchedule();
            
            // Ocultar formulario
            document.getElementById('editForm').style.display = 'none';
            editingCell = null;
            
            showAdminMessage('Celda actualizada correctamente');
        }

        function cancelEdit() {
            document.getElementById('editForm').style.display = 'none';
            editingCell = null;
        }

        function saveAllChanges() {
            if (currentUser !== 'admin-yara') {
                alert('Solo el administrador puede realizar esta acción');
                return;
            }
            
            // En una aplicación real, aquí se enviarían los cambios al servidor
            showAdminMessage('Cambios guardados correctamente en la base de datos');
        }

        function showAdminMessage(message) {
            const messageDiv = document.getElementById('adminMessage');
            document.getElementById('messageText').textContent = message;
            messageDiv.style.display = 'block';
            
            setTimeout(() => {
                messageDiv.style.display = 'none';
            }, 3000);
        }
    </script>
</body>
</html>
